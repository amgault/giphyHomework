<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Document</title>

		<!-- Bootstrap -->
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

		<style>

		.images {
			display: inline-block;
			margin: 6px;
		}
		.topic {
			line-height: 200%;
			padding: 0 24px;
			margin: 12px 6px;
			display: block;
		}
		.header {
			text-align: center;
		}

		</style>

	</head>
	
	<body>

		<div class="container">
			<div class="row">
				<div class="header">
					<div class="panel panel-default">
  						<div class="panel-body header">
    						<h1>Giphy Search</h1>
  						</div>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-lg-3">
					<div class="panel panel-info panel-default">
  						<div class="panel-heading">
    						<h3 class="panel-title">Search terms</h3>
  						</div>
  						<div class="panel-body">
  							<form id="movie-form">
      							<label for="topic-input">Add an animal</label>
     							<input type="text" id="topic-input"><br>
      							<input id="add-topic" type="submit" value="Submit">
    						</form>
  							<div id="buttons"></div>
  						</div>
					</div>
				</div>
				<div class="col-lg-9">
					<div class="panel panel-info panel-default">
  						<div class="panel-body" id="images">
   	 						<img id="myImage" src="" alt="">
  						</div>
					</div>
				</div>
			</div>

		</div>

		<script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>

		<script>

		var topics = ['Dog', 'Cat', 'skunk', 'Lion', 'Tiger'];
		// http://api.giphy.com/v1/gifs/search?limit=10&api_key=dc6zaTOxFJmzC&q={search term}

		var queryURL = 'http://api.giphy.com/v1/gifs/search?limit=10&api_key=dc6zaTOxFJmzC&q=';

		var searchTerm = null;

		function getImages(topic) {
			var fullUrl = queryURL + topic;

			$.ajax({
				url: fullUrl,
				method: 'GET'
			}).done(function(response) {
				console.log(response);
				displayImages(response);
			});
		}	

		function displayImages(images) {
			$('#images').empty();

			for(var i = 0; i < images.data.length; i++) {
				var imgDIV = $('<div>');
				var img = $('<img>');
				var rating = $('<p>');
				imgDIV.addClass('images');
				img.addClass('image');
				console.log(images.data[i].images.downsized.url);
				img.attr('data-still', images.data[i].images.downsized_still.url);
				img.attr('data-animate', images.data[i].images.downsized.url);
				img.attr('src', images.data[i].images.downsized_still.url);
				img.attr('data-state', 'still');
				rating.html('Rating: ' + images.data[i].rating);
				imgDIV.append(rating);
				imgDIV.append(img);
				$('#images').append(imgDIV);
			}
		}

		function displayButtons(buttons) {

			$('#buttons').empty();
			
			for(var i = 0; i < buttons.length; i++) {
				console.log('hi');
				var button = $('<button>');
				button.addClass('topic btn btn-info')
				button.attr('data-name', buttons[i]);
				button.html(buttons[i]);
				$('#buttons').append(button);
			}
		}

		$("#images").on("click", ".image", function() {
	    // The attr jQuery method allows us to get or set the value of any attribute on our HTML element
	    	event.preventDefault();

	    	console.log($(this).attr("data-state"));

			var state = $(this).attr("data-state");
			// If the clicked image's state is still, update its src attribute to what its data-animate value is.
			// Then, set the image's data-state to animate
			// Else set src to the data-still value
			if (state === "still") {
				$(this).attr("src", $(this).attr("data-animate"));
				$(this).attr("data-state", "animate");
			} else {
				$(this).attr("src", $(this).attr("data-still"));
				$(this).attr("data-state", "still");
			}
   		});

   		$("#buttons").on("click", ".topic", function() {
   			event.preventDefault();
   			console.log($(this).attr("data-name"));
   			searchTerm = $(this).attr("data-name");

   			getImages(searchTerm);
   		});

   		$("#add-topic").on("click", function() {

   			event.preventDefault();

   			var topic = $("#topic-input").val().trim();
   			topics.push(topic);
   			console.log(topics);

   			displayButtons(topics);
   		});

		displayButtons(topics);

		</script>
		
	</body>
</html>